gcc -shared -o kdtrees.so kdtrees.c -I/usr/local/Cellar/python@3.11/3.11.2_1/Frameworks/Python.framework/Versions/3.11/include/python3.11/ -L/usr/local/Cellar/python@3.11/3.11.2_1/Frameworks/Python.framework/Versions/3.11/lib -lpython3.11
gcc -shared -o kdtrees.so kdtrees.c -I/usr/local/Cellar/python@3.9/3.9.1/Frameworks/Python.framework/Versions/3.9/include/python3.9/ -L/usr/local/Cellar/python@3.9/3.9.1/Frameworks/Python.framework/Versions/3.9/lib -lpython3.9
(Linux Ubuntu)
gcc -shared -Wl,-soname,mymodule -o mymodule.so -fPIC mymodule.c -I/usr/include/python3.9m


Calculate SHAP value: while SHAP shows the contribution or the importance of each feature on the prediction of the model, it does not evaluate the quality of the prediction itself.
https://zhanggroup.org/BioLiP/weekly.html

Chimera: in command line (Favorites):
    select:97, 99, 67 .... all the residues we want to paint


3pgq_2 -> passed becaues it is too long: 10k R (without counting the H)

https://yeun.github.io/open-color/ingredients.html
The probability of the binding site will be painted as follows
PERCENTAGE  RGB 0-1
0-10%       1,0.96,0.9
10-20%      1,0.91,0.8
20-30%      1,0.85,0.65
30-40%      1,0.75,0.47
40-50%      1,0.66,0.3
50-60%      1,0.57,0.17
60-70%      0.99,0.49,0.08
70-80%      0.97,0.4,0.03
80-90%      0.91,0.35,0.05
90-100%     0.85,0.28,0.06


Linear Interaction Energy: ΔG_bind = αE_vdw + βE_ele + γE_pol + δE_nonpol + ε

molecular mechanics force fields

Scoring the docked ligands involves calculating the binding energy of each docked ligand conformation. This can be done manually using a simple scoring function that takes into account the interactions between the ligand and the protein.

Here are the steps to manually score docked ligands:

Calculate the van der Waals energy: Calculate the energy associated with the van der Waals interactions between the ligand and the protein. This can be done by summing up the attractive and repulsive van der Waals energy terms between the ligand atoms and the protein atoms. The attractive term is proportional to the inverse sixth power of the distance between the atoms, while the repulsive term is proportional to the inverse twelfth power of the distance.

Calculate the electrostatic energy: Calculate the energy associated with the electrostatic interactions between the ligand and the protein. This can be done by summing up the Coulombic energy terms between the charged ligand atoms and the charged protein atoms. The Coulombic energy is proportional to the product of the charges and the inverse distance between the atoms.

Calculate the hydrogen bonding energy: Calculate the energy associated with the hydrogen bonding interactions between the ligand and the protein. This can be done by identifying potential hydrogen bonds between the ligand and the protein and calculating the energy associated with each bond. A hydrogen bond occurs when a hydrogen atom in the ligand is close to an electronegative atom, such as an oxygen or nitrogen atom, in the protein.

Calculate the overall binding energy: Sum up the energies calculated in steps 1-3 to obtain the overall binding energy of the docked ligand conformation. This energy can be used to rank and compare the different docked ligand conformations.

It's important to note that manually scoring docked ligands can be time-consuming and may not be as accurate as using a more sophisticated scoring function. However, it can be a useful exercise to gain insight into the interactions between the ligand and the protein and to identify potential binding hotspots.


Van der Waals Energy:
The van der Waals energy between the ligand and the protein can be calculated using the Lennard-Jones potential, which models the attractive and repulsive forces between non-bonded atoms:

E_vdw = ∑i,j 4ε_ij [(σ_ij/r_ij)^12 - (σ_ij/r_ij)^6]

where:

i and j are indices for the ligand and protein atoms, respectively
ε_ij and σ_ij are the Lennard-Jones parameters for the i-j atom pair
r_ij is the distance between the i and j atoms
Electrostatic Energy:
The electrostatic energy between the ligand and the protein can be calculated using the Coulombic potential, which models the attraction and repulsion between charged particles:

E_ele = ∑i,j (q_iq_j)/εr_ij

where:

i and j are indices for the ligand and protein atoms, respectively
q_i and q_j are the partial charges on the i and j atoms, respectively
ε is the dielectric constant of the solvent
r_ij is the distance between the i and j atoms
Hydrogen Bonding Energy:
The hydrogen bonding energy between the ligand and the protein can be estimated using a simple geometric criterion, such as the distance and angle criteria:

E_hbond = -δH - TδS = -α(1/r_HA + 1/r_DA) + β(θ_HAD - θ_HAD0)

where:

δH and δS are the enthalpy and entropy changes associated with hydrogen bonding
T is the temperature in Kelvin
r_HA and r_DA are the distances between the hydrogen donor (H) and acceptor (A) atoms, and between the donor and the hydrogen bond acceptor (D) atoms, respectively
θ_HAD is the angle between the H-A and H-D vectors
θ_HAD0 is the optimal angle for hydrogen bonding
α and β are weighting factors that control the strength of the distance and angle terms, respectively
Overall Binding Energy:
The overall binding energy can be calculated by summing the van der Waals, electrostatic, and hydrogen bonding energies:

ΔG_bind = E_vdw + E_ele + E_hbond

where:

ΔG_bind is the total binding energy of the ligand-protein complex.